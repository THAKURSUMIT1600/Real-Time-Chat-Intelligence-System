<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chat Intelligence System</title>

    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>

    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

    <!-- Custom CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <div class="container-fluid h-100">
      <div class="row h-100">
        <!-- Sidebar -->
        <div class="col-md-3 col-lg-2 bg-dark text-white p-3 sidebar">
          <h4 class="mb-4">
            <i class="bi bi-chat-dots-fill"></i> Chat Intelligence
          </h4>

          <!-- User Info -->
          <div
            class="user-info mb-4"
            id="userInfoSection"
            style="display: none"
          >
            <div class="card bg-secondary text-white">
              <div class="card-body p-2">
                <small>Logged in as:</small>
                <div class="fw-bold" id="currentUsername"></div>
              </div>
            </div>
          </div>

          <!-- Login Form -->
          <div class="login-form mb-4" id="loginForm">
            <div class="mb-3">
              <label for="usernameInput" class="form-label">Username</label>
              <input
                type="text"
                class="form-control"
                id="usernameInput"
                placeholder="Enter username"
              />
            </div>
            <div class="mb-3">
              <label for="roomInput" class="form-label">Room</label>
              <input
                type="text"
                class="form-control"
                id="roomInput"
                value="general"
                placeholder="Room name"
              />
            </div>
            <button class="btn btn-primary w-100" id="joinBtn">
              <i class="bi bi-box-arrow-in-right"></i> Join Chat
            </button>
          </div>

          <!-- Room Info -->
          <div class="room-info" id="roomInfo" style="display: none">
            <h6 class="text-muted">Current Room</h6>
            <div class="badge bg-success mb-3" id="currentRoom">general</div>

            <button class="btn btn-danger btn-sm w-100 mb-3" id="leaveBtn">
              <i class="bi bi-box-arrow-left"></i> Leave Room
            </button>

            <hr class="bg-secondary" />

            <h6 class="text-muted">System Stats</h6>
            <small>
              <div>Messages: <span id="messageCount">0</span></div>
              <div>
                Status:
                <span class="badge bg-success" id="connectionStatus"
                  >Connected</span
                >
              </div>
            </small>
          </div>
        </div>

        <!-- Main Content -->
        <div class="col-md-9 col-lg-10 p-0 main-content">
          <!-- Tabs -->
          <ul class="nav nav-tabs" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button
                class="nav-link active"
                id="chat-tab"
                data-bs-toggle="tab"
                data-bs-target="#chat-panel"
                type="button"
              >
                <i class="bi bi-chat-left-text"></i> Chat
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button
                class="nav-link"
                id="analytics-tab"
                data-bs-toggle="tab"
                data-bs-target="#analytics-panel"
                type="button"
              >
                <i class="bi bi-graph-up"></i> Analytics
              </button>
            </li>
          </ul>

          <div class="tab-content h-100" id="mainTabContent">
            <!-- Chat Panel -->
            <div class="tab-pane fade show active h-100" id="chat-panel">
              <div class="d-flex flex-column h-100">
                <!-- Messages Area -->
                <div
                  class="flex-grow-1 overflow-auto p-3"
                  id="messagesContainer"
                >
                  <div class="text-center text-muted p-5">
                    <i
                      class="bi bi-chat-square-dots"
                      style="font-size: 3rem"
                    ></i>
                    <p class="mt-3">No messages yet. Start chatting!</p>
                  </div>
                </div>

                <!-- Message Input -->
                <div
                  class="p-3 bg-light border-top"
                  id="messageInputSection"
                  style="display: none"
                >
                  <form id="messageForm" class="d-flex gap-2">
                    <input
                      type="text"
                      class="form-control"
                      id="messageInput"
                      placeholder="Type your message..."
                      maxlength="500"
                      disabled
                    />
                    <button
                      type="submit"
                      class="btn btn-primary"
                      id="sendBtn"
                      disabled
                    >
                      <i class="bi bi-send-fill"></i> Send
                    </button>
                  </form>
                  <small class="text-muted">
                    <span id="charCount">0</span>/500 characters
                  </small>
                </div>
              </div>
            </div>

            <!-- Analytics Panel -->
            <div class="tab-pane fade p-4" id="analytics-panel">
              <h3 class="mb-4">
                <i class="bi bi-graph-up-arrow"></i> Live Analytics Dashboard
              </h3>

              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header bg-primary text-white">
                      <i class="bi bi-emoji-smile"></i> Emotion Distribution
                    </div>
                    <div class="card-body">
                      <canvas id="emotionChart"></canvas>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header bg-success text-white">
                      <i class="bi bi-tag"></i> Top Entities
                    </div>
                    <div class="card-body">
                      <canvas id="entityChart"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header bg-info text-white">
                      <i class="bi bi-bar-chart"></i> Aspect Sentiment
                    </div>
                    <div class="card-body">
                      <canvas id="sentimentChart"></canvas>
                    </div>
                  </div>
                </div>

                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header bg-warning text-dark">
                      <i class="bi bi-info-circle"></i> Analytics Summary
                    </div>
                    <div class="card-body">
                      <div id="analyticsSummary">
                        <p class="text-muted">Loading analytics...</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="text-center mt-4">
                <button class="btn btn-primary" id="refreshAnalyticsBtn">
                  <i class="bi bi-arrow-clockwise"></i> Refresh Analytics
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>
